<!DOCTYPE html>
<html>
<head>
  <meta charset="iso-8859-1">
</head>
<body lang="fr-TN">
<div id="bodyContent" style="font-family: Arial, sans-serif;">
  <p style="margin-bottom: 1em;">
    BONJOUR,
  </p>

  {{#if (eq company "canpol")}}
    <p style="margin-bottom: 1em;">
      JE VOUS FAIS PARVENIR DES COMMANDES REÇUES SUR LE COMPTE CANPOL TUNISIE
    </p>
  {{else if (eq company "beureur")}}
    <p style="margin-bottom: 1em;">
      JE VOUS FAIS PARVENIR DES COMMANDES REÇUES SUR LE COMPTE BEURER TUNISIE
    </p>
  {{else if (eq company "titania")}}
    <p style="margin-bottom: 1em;">
      JE VOUS FAIS PARVENIR DES COMMANDES REÇUES SUR LE COMPTE TITANIA TUNISIE
    </p>
  {{else if (eq company "TECHWOOD")}}
    <p style="margin-bottom: 1em;">
      JE VOUS FAIS PARVENIR DES COMMANDES REÇUES SUR LE COMPTE TECHWOOD TUNISIE
    </p>
  {{else if (eq company "NATURTINT ")}}
    <p style="margin-bottom: 1em;">
      JE VOUS FAIS PARVENIR DES COMMANDES REÇUES SUR LE COMPTE NATURTINT  TUNISIE
    </p>
  {{else if (eq company "POLARBOX ")}}
    <p style="margin-bottom: 1em;">
      JE VOUS FAIS PARVENIR DES COMMANDES REÇUES SUR LE COMPTE POLARBOX  TUNISIE
    </p>
  {{/if}}

  <p style="margin-bottom: 1em;">
    VEUILLEZ TROUVER CI-DESSOUS LES DÉTAILS DE LA COMMANDE :
  </p>

  <!-- Main Table -->
  <table 
    style="
      border-collapse: collapse; 
      width: 100%; 
      max-width: 700px; /* Adjust max-width as needed */
      table-layout: fixed; 
      margin-bottom: 1em;"
  >
    <thead>
      <tr>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Client
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Téléphone
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Adresse
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Code Saari
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Produit
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Quantité
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Prix TTC
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          TBR
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Livraison
        </th>
        <th 
          style="
            border: 1px solid black; 
            padding: 5px; 
            background: {{tableBackground}}; 
            color: {{tableColor}}; 
            word-break: break-word;
          "
        >
          Total
        </th>
      </tr>
    </thead>
    <tbody>
      {{#each clients}}
        {{#each products}}
          <tr
            style="
              border: 1px solid black; 
              word-break: break-word; 
              {{#if @first}}border-top: 3px solid black;{{/if}}
            "
          >
            {{#if @first}}
              <!-- Rowspan cells for first product of each client -->
              <td 
                style="
                  border: 1px solid black; 
                  padding: 5px; 
                  vertical-align: top;
                " 
                rowspan="{{../products.length}}"
              >
                {{../client_name}}
              </td>
              <td 
                style="
                  border: 1px solid black; 
                  padding: 5px; 
                  vertical-align: top;
                " 
                rowspan="{{../products.length}}"
              >
                {{../phone}}
              </td>
              <td 
                style="
                  border: 1px solid black; 
                  padding: 5px; 
                  vertical-align: top;
                " 
                rowspan="{{../products.length}}"
              >
                {{../address}}
              </td>
            {{/if}}
            <td 
              style="
                border: 1px solid black; 
                padding: 5px; 
                vertical-align: top;
              "  
            >
              {{product_code}}
            </td>
            <td 
              style="
                border: 1px solid black; 
                padding: 5px; 
                vertical-align: top;
              "
            >
              {{product_name}}
            </td>
            <td 
              style="
                border: 1px solid black; 
                padding: 5px; 
                vertical-align: top;
              "
            >
              {{quantity}}
            </td>
            <td 
              style="
                border: 1px solid black; 
                padding: 5px; 
                vertical-align: top;
              "
            >
              {{price_ttc}}
            </td>
            {{#if @first}}
              <td 
                style="
                  border: 1px solid black; 
                  padding: 5px; 
                  vertical-align: top;
                " 
                rowspan="{{../products.length}}"
              >
                {{../order_tbr}}
              </td>
              <td 
                style="
                  border: 1px solid black; 
                  padding: 5px; 
                  vertical-align: top;
                " 
                rowspan="{{../products.length}}"
              >
                {{../order_livr}}
              </td>
              <td 
                style="
                  border: 1px solid black; 
                  padding: 5px; 
                  vertical-align: top;
                " 
                rowspan="{{../products.length}}"
              >
                {{../order_grand_total}}
              </td>
            {{/if}}
          </tr>
        {{/each}}
      {{/each}}
    </tbody>
  </table>

  <p style="margin-bottom: 1em;">
    Merci de me confirmer la réception de la commande.
  </p>
</div>

<!-- Copy button (optional) -->
<button 
  onclick="copyBodyContent()" 
  style="
    display: inline-block; 
    padding: 8px 12px; 
    font-size: 14px; 
    cursor: pointer;
  "
>
  Copier tout le contenu
</button>

<script>
  function copyBodyContent() {
    const bodyContent = document.getElementById('bodyContent');
    const range = document.createRange();
    const selection = window.getSelection();

    range.selectNode(bodyContent);
    selection.removeAllRanges();
    selection.addRange(range);

    try {
      document.execCommand('copy');
      alert('Le contenu complet a été copié dans le presse-papiers.');
    } catch (err) {
      alert('Impossible de copier le contenu complet.');
    }

    selection.removeAllRanges();
  }
</script>

</body>
</html>
